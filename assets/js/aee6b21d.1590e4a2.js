"use strict";(self.webpackChunkczertainly=self.webpackChunkczertainly||[]).push([[7055],{17820:function(e,n,i){i.r(n),i.d(n,{assets:function(){return a},contentTitle:function(){return s},default:function(){return u},frontMatter:function(){return l},metadata:function(){return r},toc:function(){return c}});var t=i(85893),o=i(11151);const l={},s="Install PSPKI Module",r={id:"certificate-key/integration-guides/adcs/install-pspki",title:"Install PSPKI Module",description:"The PSPKI module for PowerShell is intended to simplify various PKI and Active Directory Certificate Services management tasks by using automation with Windows PowerShell. The module provides features and capabilities for managing and configuring Certification Authorities.",source:"@site/docs/10-certificate-key/20-integration-guides/14-adcs/03-install-pspki.md",sourceDirName:"10-certificate-key/20-integration-guides/14-adcs",slug:"/certificate-key/integration-guides/adcs/install-pspki",permalink:"/docs/certificate-key/integration-guides/adcs/install-pspki",draft:!1,unlisted:!1,editUrl:"https://github.com/3KeyCompany/CZERTAINLY-Documentation/edit/documentation/docs/10-certificate-key/20-integration-guides/14-adcs/03-install-pspki.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/docs/certificate-key/integration-guides/adcs/overview"},next:{title:"WinRM Configuration",permalink:"/docs/certificate-key/integration-guides/adcs/winrm-configuration"}},a={},c=[{value:"Installation steps",id:"installation-steps",level:2},{value:"Test PSPKI module installation",id:"test-pspki-module-installation",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"install-pspki-module",children:"Install PSPKI Module"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"https://github.com/PKISolutions/PSPKI",children:(0,t.jsx)(n.strong,{children:"PSPKI module for PowerShell"})})," is intended to simplify various PKI and Active Directory Certificate Services management tasks by using automation with Windows PowerShell. The module provides features and capabilities for managing and configuring Certification Authorities."]}),"\n",(0,t.jsx)(n.p,{children:"Although it is an optional component, majority of providers and connectors are using it to provide better user experience and more features."}),"\n",(0,t.jsx)(n.p,{children:"To install the PSPKI module, first make sure you are using the newest version of PowerShell from Microsoft. At least version 5 is required."}),"\n",(0,t.jsx)(n.admonition,{title:"PSPKI module requirements",type:"info",children:(0,t.jsxs)(n.p,{children:["The PSPKI module requires Windows PowerShell 3.0 or higher and .NET Framework 4.7.2 or higher. Check the ",(0,t.jsx)(n.a,{href:"https://github.com/PKISolutions/PSPKI",children:"official project page"})," for more information."]})}),"\n",(0,t.jsx)(n.h2,{id:"installation-steps",children:"Installation steps"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Enable TLSv1.2 Protocol for PowerShell by running the following in an elevated PowerShell console on the server:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Register a PSRepository for installation of modules to PowerShell by running the following in an elevated PowerShell console on the server:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"Register-PSRepository -Default\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Finally, install the PSPKI module by running the following in an elevated PowerShell console on the server:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"Install-Module -Name PSPKI\n"})}),"\n",(0,t.jsx)(n.h2,{id:"test-pspki-module-installation",children:"Test PSPKI module installation"}),"\n",(0,t.jsx)(n.p,{children:"To test the PSPKI module, run the following in PowerShell console on the server:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"Get-Command -Module PSPKI\n"})}),"\n",(0,t.jsx)(n.p,{children:"The output should look similar to this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"\nCommandType     Name                                               Version    Source\n-----------     ----                                               -------    ------\nAlias           Add-AIA                                            3.7.2      PSPKI\nAlias           Add-CAAccessControlEntry                           3.7.2      PSPKI\nAlias           Add-CAACL                                          3.7.2      PSPKI\nAlias           Add-CDP                                            3.7.2      PSPKI\nAlias           Add-OCSPACL                                        3.7.2      PSPKI\nAlias           Connect-CA                                         3.7.2      PSPKI\nAlias           Disable-CRLFlag                                    3.7.2      PSPKI\nAlias           Disable-KRAFlag                                    3.7.2      PSPKI\nAlias           Enable-CRLFlag                                     3.7.2      PSPKI\nAlias           Enable-KRAFlag                                     3.7.2      PSPKI\nAlias           Get-AIA                                            3.7.2      PSPKI\nAlias           Get-CA                                             3.7.2      PSPKI\nAlias           Get-CAACL                                          3.7.2      PSPKI\nAlias           Get-CASecurityDescriptor                           3.7.2      PSPKI\nAlias           Get-CDP                                            3.7.2      PSPKI\nAlias           Get-CRL                                            3.7.2      PSPKI\nAlias           Get-CRLFlag                                        3.7.2      PSPKI\nAlias           Get-Csp                                            3.7.2      PSPKI\nAlias           Get-CTL                                            3.7.2      PSPKI\n...\n"})}),"\n",(0,t.jsxs)(n.admonition,{title:"Using PSPKI module",type:"tip",children:[(0,t.jsx)(n.p,{children:"Using PSPKI module commands requires to import the module first. To import the module, run the following in PowerShell console on the server:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-powershell",children:"Import-Module PSPKI\n"})})]})]})}function u(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},11151:function(e,n,i){i.d(n,{Z:function(){return r},a:function(){return s}});var t=i(67294);const o={},l=t.createContext(o);function s(e){const n=t.useContext(l);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(l.Provider,{value:n},e.children)}}}]);