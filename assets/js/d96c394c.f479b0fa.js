"use strict";(self.webpackChunkczertainly=self.webpackChunkczertainly||[]).push([[9824],{64207:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>o});var i=t(85893),r=t(11151);const s={},a="Overview",l={id:"certificate-key/installation-guide/deployment/deployment-helm/overview",title:"Overview",description:"Helm chart simplifies the deployment of the platform using already pre-defined templates that are parsed as Kubernetes manifests and managed by Helm.",source:"@site/docs/10-certificate-key/03-installation-guide/04-deployment/04-deployment-helm/overview.md",sourceDirName:"10-certificate-key/03-installation-guide/04-deployment/04-deployment-helm",slug:"/certificate-key/installation-guide/deployment/deployment-helm/overview",permalink:"/docs/certificate-key/installation-guide/deployment/deployment-helm/overview",draft:!1,unlisted:!1,editUrl:"https://github.com/3KeyCompany/CZERTAINLY-Documentation/edit/documentation/docs/10-certificate-key/03-installation-guide/04-deployment/04-deployment-helm/overview.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Deployment Options",permalink:"/docs/certificate-key/installation-guide/deployment/deployment-options"},next:{title:"Configurable parameters",permalink:"/docs/certificate-key/installation-guide/deployment/deployment-helm/configurable-parameters"}},c={},o=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Using this Chart",id:"using-this-chart",level:2},{value:"Installation",id:"installation",level:3},{value:"Upgrade",id:"upgrade",level:3},{value:"Uninstall",id:"uninstall",level:3},{value:"Persistence",id:"persistence",level:2}];function d(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"Helm chart simplifies the deployment of the platform using already pre-defined templates that are parsed as Kubernetes manifests and managed by Helm."}),"\n",(0,i.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Kubernetes 1.19+"}),"\n",(0,i.jsx)(n.li,{children:"Helm 3.8.0+"}),"\n",(0,i.jsx)(n.li,{children:"PostgreSQL 12+"}),"\n",(0,i.jsx)(n.li,{children:"PV provisioner support in the underlying infrastructure"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"In case you want to enable Ingress you need to have installed Ingress Controller, for example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v1.7.0/deploy/static/provider/cloud/deploy.yaml\n"})}),"\n",(0,i.jsxs)(n.p,{children:["If you are using internal CA for Ingress and Administrator certificate, you also need to have installed ",(0,i.jsx)(n.a,{href:"https://cert-manager.io/docs/",children:"cert-manager"}),"."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"cert-manager is only required to use certificates issued by internally generated CA:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ingress.certificate.source=internal"})," for internally generated Ingress certificate"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ingress.certificate.source=letsEncrypt"})," for Ingress Let\u2019s Encrypt issued certificate"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"registerAdmin.source=generated"})," for internally generated certificate for first administrator"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"using-this-chart",children:"Using this Chart"}),"\n",(0,i.jsx)(n.h3,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Create namespace"})}),"\n",(0,i.jsx)(n.p,{children:"We\u2019ll need to define a Kubernetes namespace where the resources created by the Chart should be installed:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kubectl create namespace czertainly\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.strong,{children:["Create ",(0,i.jsx)(n.code,{children:"czertainly-values.yaml"})]})}),"\n",(0,i.jsxs)(n.p,{children:["Copy the default ",(0,i.jsx)(n.code,{children:"values.yaml"})," from the CZERTAINLY Helm chart and modify the values accordingly:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm show values oci://harbor.3key.company/czertainly-helm/czertainly > czertainly-values.yaml\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now edit the ",(0,i.jsx)(n.code,{children:"czertainly-values.yaml"})," according to your desired stated, see ",(0,i.jsx)(n.a,{href:"/docs/certificate-key/installation-guide/deployment/deployment-helm/configurable-parameters",children:"Configurable parameters"})," for more information."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Prepare list of trusted CA certificates"})}),"\n",(0,i.jsxs)(n.p,{children:["Create new file called ",(0,i.jsx)(n.code,{children:"trusted-certificates.pem"})," and add to the file PEM certificates of all certification authorities that should be trusted by the platform. No worries, you can always change the list of trusted certificates in the future."]}),"\n",(0,i.jsx)(n.p,{children:"The list of trusted certificates is need for the installation of the CZERTAINLY using Helm chart."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Note"}),"\nTrusted certificates can be defined globally for the CZERTAINLY chart and all of its sub-charts, or it can be applied only for specific sub-chart, see ",(0,i.jsx)(n.a,{href:"/docs/certificate-key/installation-guide/deployment/deployment-helm/configurable-parameters#global-parameters",children:"global parameters"}),". For global, set ",(0,i.jsx)(n.code,{children:"global.trusted.certificates"}),", otherwise set ",(0,i.jsx)(n.code,{children:"trusted.certificates"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Install CZERTAINLY"})}),"\n",(0,i.jsxs)(n.p,{children:["There are couple of options to install CZERTAINLY based on you TLS configuration and administrator certificate handling. See the ",(0,i.jsx)(n.a,{href:"/docs/certificate-key/installation-guide/deployment/deployment-helm/configurable-parameters",children:"Configurable parameters"})," for more information."]}),"\n",(0,i.jsx)(n.p,{children:"For the basic installation, run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm install --namespace czertainly -f czertainly-values.yaml --set-file global.trusted.certificates=trusted-certificates.pem czertainly-tlm oci://harbor.3key.company/czertainly-helm/czertainly\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Save your configuration"})}),"\n",(0,i.jsxs)(n.p,{children:["Always make sure you save the ",(0,i.jsx)(n.code,{children:"czertainly-values.yaml"})," and all ",(0,i.jsx)(n.code,{children:"--set"})," and ",(0,i.jsx)(n.code,{children:"--set-file"})," options you used. You will need to use the same options when you upgrade CZERTAINLY to new versions with Helm. In case you are changing the configuration, save the new configuration."]}),"\n",(0,i.jsx)(n.h3,{id:"upgrade",children:"Upgrade"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Warning"}),"\nBe sure that you always save your previous configuration!"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"For upgrading the CZERTAINLY installation, update your configuration and run:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm upgrade --namespace czertainly -f czertainly-values.yaml --set-file global.trusted.certificates=trusted-certificates.pem czertainly-tlm oci://harbor.3key.company/czertainly-helm/czertainly\n"})}),"\n",(0,i.jsx)(n.h3,{id:"uninstall",children:"Uninstall"}),"\n",(0,i.jsxs)(n.p,{children:["You can use the ",(0,i.jsx)(n.code,{children:"helm uninstall"})," command to uninstall the CZERTAINLY:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"helm uninstall --namespace czertainly czertainly-tlm\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Helm chart",type:"info",children:(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"https://github.com/3KeyCompany/CZERTAINLY-Helm-Charts",children:"CZERTAINLY-Helm-Charts"})," for description of all charts and sub-charts that are available for the platform."]})}),"\n",(0,i.jsx)(n.h2,{id:"persistence",children:"Persistence"}),"\n",(0,i.jsx)(n.p,{children:"Internal services can use Persistence Volume Claims to store the data. The PVC is created dynamically by default, but different behaviour can be configured."}),"\n",(0,i.jsx)(n.p,{children:"The following sub-charts requires persistence:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Messaging RabbitMQ"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>l,a:()=>a});var i=t(67294);const r={},s=i.createContext(r);function a(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);