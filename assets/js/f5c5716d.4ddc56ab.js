"use strict";(self.webpackChunkczertainly=self.webpackChunkczertainly||[]).push([[9670],{89409:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>a});var t=i(85893),r=i(11151);const s={},o="nCipher PKCS#11 Installation",c={id:"signing/qscd-integration/nshield-xc-cc/middleware",title:"nCipher PKCS#11 Installation",description:"11 Installation",source:"@site/docs/30-signing/25-qscd-integration/09-nshield-xc-cc/09-middleware.md",sourceDirName:"30-signing/25-qscd-integration/09-nshield-xc-cc",slug:"/signing/qscd-integration/nshield-xc-cc/middleware",permalink:"/docs/signing/qscd-integration/nshield-xc-cc/middleware",draft:!1,unlisted:!1,editUrl:"https://github.com/3KeyCompany/CZERTAINLY-Documentation/edit/documentation/docs/30-signing/25-qscd-integration/09-nshield-xc-cc/09-middleware.md",tags:[],version:"current",sidebarPosition:9,frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Issue and Import Certificate",permalink:"/docs/signing/qscd-integration/nshield-xc-cc/issuecert"},next:{title:"Crypto Token Configuration",permalink:"/docs/signing/qscd-integration/nshield-xc-cc/cryptotoken"}},d={},a=[{value:"Install nCipher PKCS#11 libraries",id:"install-ncipher-pkcs11-libraries",level:2},{value:"Configuration of nCipher PKCS#11 middleware",id:"configuration-of-ncipher-pkcs11-middleware",level:2},{value:"Using softcard with PKCS#11",id:"using-softcard-with-pkcs11",level:3},{value:"Configure nCipher PKCS#11 for SignServer",id:"configure-ncipher-pkcs11-for-signserver",level:2}];function l(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,r.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"ncipher-pkcs11-installation",children:"nCipher PKCS#11 Installation"}),"\n",(0,t.jsx)(n.p,{children:"nShield XC CC comes with the PKCS#11 middleware that is used in order to integrate with the PKCS#11 Crypto Token of the SignServer. You can use the following instructions in order to install the nCipher PKCS#11 middleware to be used with the SignServer."}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"The following document assumes installation on the Linux system, however, the steps can be reproduced on other OS with different libraries."})}),"\n",(0,t.jsx)(n.h2,{id:"install-ncipher-pkcs11-libraries",children:"Install nCipher PKCS#11 libraries"}),"\n",(0,t.jsxs)(n.p,{children:["nCipher PKCS#11 library is installed as part of the nShield Core Tools, or ",(0,t.jsx)(n.code,{children:"ctls"})," package. It contains management utilities, including generatekey, diagnostic and performance tools, Remote Administration Client tools, and the PKCS#11 library."]}),"\n",(0,t.jsx)(n.p,{children:"Once installed, you can find the shared PKCS#11 middleware in:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"/opt/nfast/toolkits/pkcs11/libcknfast.so\n"})}),"\n",(0,t.jsxs)(n.p,{children:["It is important, that the user that runs the SignServer (and the application server) has proper permission to use ",(0,t.jsx)(n.code,{children:"libcknfast.so"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsxs)(n.p,{children:["For information on how to install Security World software, see the appropriate ",(0,t.jsx)(n.strong,{children:"nShield Installation Guide"}),"."]})}),"\n",(0,t.jsx)(n.h2,{id:"configuration-of-ncipher-pkcs11-middleware",children:"Configuration of nCipher PKCS#11 middleware"}),"\n",(0,t.jsxs)(n.p,{children:["There are various options how to use nCipher PKCS#11 middleware depending on the protection level (OCS, softcard).\nIt is recommended to configure the middleware according the ",(0,t.jsx)(n.strong,{children:"Using the nCipher PKCS #11 library"})," section of the ",(0,t.jsx)(n.strong,{children:"nShield User Guide"})]}),"\n",(0,t.jsx)(n.h3,{id:"using-softcard-with-pkcs11",children:"Using softcard with PKCS#11"}),"\n",(0,t.jsxs)(n.p,{children:["To use softcards with PKCS#11, you must have ",(0,t.jsx)(n.code,{children:"CKNFAST_LOADSHARING"})," set to a nonzero value. When using pre-loaded softcards or other objects, the PKCS#11 library automatically sets ",(0,t.jsx)(n.code,{children:"CKNFAST_LOADSHARING=1"})," (load-sharing mode on) unless it has been explicitly set to 0 (load-sharing mode off)."]}),"\n",(0,t.jsx)(n.h2,{id:"configure-ncipher-pkcs11-for-signserver",children:"Configure nCipher PKCS#11 for SignServer"}),"\n",(0,t.jsxs)(n.p,{children:["In order SignServer get access to the nShield XC CC, it needs to be configured and available for the SignServer. This is configured as ",(0,t.jsx)(n.code,{children:"cryptotoken"})," in the ",(0,t.jsx)(n.code,{children:"signserver_deploy.properties"})," as follows:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"cryptotoken.p11.lib.110.name = nShieldXCCC\ncryptotoken.p11.lib.110.file = /opt/nfast/toolkits/pkcs11/libcknfast.so\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Once the nCipher PKCS#11 is configured in ",(0,t.jsx)(n.code,{children:"signserver_deploy.properties"}),", SignServer must be redeployed to reflect changes and access the nShield XC CC."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"bin/ant deploy\n"})}),"\n",(0,t.jsx)(n.p,{children:"Make sure the application server is running and verify that SignServer was deployed correctly."})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},11151:(e,n,i)=>{i.d(n,{Z:()=>c,a:()=>o});var t=i(67294);const r={},s=t.createContext(r);function o(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);